import { bm as exists, bn as BaseAPI, bo as JSONApiResponse, bp as RequiredError, aC as createDirective, bq as getPortalProxy, br as closePortals, aw as isKeyCode } from "./index.b3ce9310.js";
const PlaylistVisibility = {
  Public: "Public",
  Private: "Private",
  Unlisted: "Unlisted"
};
function PlaylistVisibilityFromJSON(json) {
  return PlaylistVisibilityFromJSONTyped(json);
}
function PlaylistVisibilityFromJSONTyped(json, ignoreDiscriminator) {
  return json;
}
function PlaylistVisibilityToJSON(value) {
  return value;
}
function PlaylistCreateRequestToJSON(value) {
  if (value === void 0) {
    return void 0;
  }
  if (value === null) {
    return null;
  }
  return {
    "name": value.name,
    "visibility": PlaylistVisibilityToJSON(value.visibility)
  };
}
function PlaylistItemReadDtoFromJSON(json) {
  return PlaylistItemReadDtoFromJSONTyped(json);
}
function PlaylistItemReadDtoFromJSONTyped(json, ignoreDiscriminator) {
  if (json === void 0 || json === null) {
    return json;
  }
  return {
    "trackId": !exists(json, "trackId") ? void 0 : json["trackId"],
    "index": !exists(json, "index") ? void 0 : json["index"],
    "timesPlayed": !exists(json, "timesPlayed") ? void 0 : json["timesPlayed"],
    "dateAdded": !exists(json, "dateAdded") ? void 0 : new Date(json["dateAdded"])
  };
}
function PlaylistTypeFromJSON(json) {
  return PlaylistTypeFromJSONTyped(json);
}
function PlaylistTypeFromJSONTyped(json, ignoreDiscriminator) {
  return json;
}
function PlaylistReadDtoFromJSON(json) {
  return PlaylistReadDtoFromJSONTyped(json);
}
function PlaylistReadDtoFromJSONTyped(json, ignoreDiscriminator) {
  if (json === void 0 || json === null) {
    return json;
  }
  return {
    "id": !exists(json, "id") ? void 0 : json["id"],
    "name": !exists(json, "name") ? void 0 : json["name"],
    "userId": !exists(json, "userId") ? void 0 : json["userId"],
    "username": !exists(json, "username") ? void 0 : json["username"],
    "visibility": !exists(json, "visibility") ? void 0 : PlaylistVisibilityFromJSON(json["visibility"]),
    "type": !exists(json, "type") ? void 0 : PlaylistTypeFromJSON(json["type"]),
    "lastModified": !exists(json, "lastModified") ? void 0 : new Date(json["lastModified"]),
    "numberOfTracks": !exists(json, "numberOfTracks") ? void 0 : json["numberOfTracks"],
    "tracks": !exists(json, "tracks") ? void 0 : json["tracks"] === null ? null : json["tracks"].map(PlaylistItemReadDtoFromJSON)
  };
}
class PlaylistApi extends BaseAPI {
  async apiPlaylistPostRaw(requestParameters, initOverrides) {
    const queryParameters = {};
    const headerParameters = {};
    headerParameters["Content-Type"] = "application/json-patch+json";
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist`,
      method: "POST",
      headers: headerParameters,
      query: queryParameters,
      body: PlaylistCreateRequestToJSON(requestParameters.playlistCreateRequest)
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => PlaylistReadDtoFromJSON(jsonValue));
  }
  async apiPlaylistPost(requestParameters = {}, initOverrides) {
    const response = await this.apiPlaylistPostRaw(requestParameters, initOverrides);
    return await response.value();
  }
  async getCurrentUserFavoriteRaw(initOverrides) {
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/user/me/favorite`,
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => jsonValue.map(PlaylistReadDtoFromJSON));
  }
  async getCurrentUserFavorite(initOverrides) {
    const response = await this.getCurrentUserFavoriteRaw(initOverrides);
    return await response.value();
  }
  async getCurrentUserHistoryRaw(initOverrides) {
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/user/me/history`,
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => jsonValue.map(PlaylistReadDtoFromJSON));
  }
  async getCurrentUserHistory(initOverrides) {
    const response = await this.getCurrentUserHistoryRaw(initOverrides);
    return await response.value();
  }
  async getCurrentUserPlaylistRaw(initOverrides) {
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/user/me`,
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => jsonValue.map(PlaylistReadDtoFromJSON));
  }
  async getCurrentUserPlaylist(initOverrides) {
    const response = await this.getCurrentUserPlaylistRaw(initOverrides);
    return await response.value();
  }
  async getCurrentUserQueueRaw(initOverrides) {
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/user/me/queue`,
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => jsonValue.map(PlaylistReadDtoFromJSON));
  }
  async getCurrentUserQueue(initOverrides) {
    const response = await this.getCurrentUserQueueRaw(initOverrides);
    return await response.value();
  }
  async getPlaylistRaw(requestParameters, initOverrides) {
    if (requestParameters.playlistId === null || requestParameters.playlistId === void 0) {
      throw new RequiredError("playlistId", "Required parameter requestParameters.playlistId was null or undefined when calling getPlaylist.");
    }
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/{playlistId}`.replace(`{${"playlistId"}}`, encodeURIComponent(String(requestParameters.playlistId))),
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => PlaylistReadDtoFromJSON(jsonValue));
  }
  async getPlaylist(requestParameters, initOverrides) {
    const response = await this.getPlaylistRaw(requestParameters, initOverrides);
    return await response.value();
  }
  async getUserPlaylistRaw(requestParameters, initOverrides) {
    if (requestParameters.userId === null || requestParameters.userId === void 0) {
      throw new RequiredError("userId", "Required parameter requestParameters.userId was null or undefined when calling getUserPlaylist.");
    }
    const queryParameters = {};
    const headerParameters = {};
    if (this.configuration && this.configuration.apiKey) {
      headerParameters["Authorization"] = this.configuration.apiKey("Authorization");
    }
    const response = await this.request({
      path: `/api/playlist/user/{userId}`.replace(`{${"userId"}}`, encodeURIComponent(String(requestParameters.userId))),
      method: "GET",
      headers: headerParameters,
      query: queryParameters
    }, initOverrides);
    return new JSONApiResponse(response, (jsonValue) => jsonValue.map(PlaylistReadDtoFromJSON));
  }
  async getUserPlaylist(requestParameters, initOverrides) {
    const response = await this.getUserPlaylistRaw(requestParameters, initOverrides);
    return await response.value();
  }
}
function getDepth(value) {
  if (value === false) {
    return 0;
  }
  if (value === true || value === void 0) {
    return 1;
  }
  const depth = parseInt(value, 10);
  return isNaN(depth) ? 0 : depth;
}
var ClosePopup = createDirective(
  {
    name: "close-popup",
    beforeMount(el, { value }) {
      const ctx = {
        depth: getDepth(value),
        handler(evt) {
          ctx.depth !== 0 && setTimeout(() => {
            const proxy = getPortalProxy(el);
            if (proxy !== void 0) {
              closePortals(proxy, evt, ctx.depth);
            }
          });
        },
        handlerKey(evt) {
          isKeyCode(evt, 13) === true && ctx.handler(evt);
        }
      };
      el.__qclosepopup = ctx;
      el.addEventListener("click", ctx.handler);
      el.addEventListener("keyup", ctx.handlerKey);
    },
    updated(el, { value, oldValue }) {
      if (value !== oldValue) {
        el.__qclosepopup.depth = getDepth(value);
      }
    },
    beforeUnmount(el) {
      const ctx = el.__qclosepopup;
      el.removeEventListener("click", ctx.handler);
      el.removeEventListener("keyup", ctx.handlerKey);
      delete el.__qclosepopup;
    }
  }
);
export { ClosePopup as C, PlaylistApi as P, PlaylistItemReadDtoFromJSON as a, PlaylistVisibility as b };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2xvc2VQb3B1cC5hNDU3ODI4Yi5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vYmFja2VuZC1zZXJ2aWNlLWFwaS9tb2RlbHMvUGxheWxpc3RWaXNpYmlsaXR5LnRzIiwiLi4vLi4vLi4vYmFja2VuZC1zZXJ2aWNlLWFwaS9tb2RlbHMvUGxheWxpc3RDcmVhdGVSZXF1ZXN0LnRzIiwiLi4vLi4vLi4vYmFja2VuZC1zZXJ2aWNlLWFwaS9tb2RlbHMvUGxheWxpc3RJdGVtUmVhZER0by50cyIsIi4uLy4uLy4uL2JhY2tlbmQtc2VydmljZS1hcGkvbW9kZWxzL1BsYXlsaXN0VHlwZS50cyIsIi4uLy4uLy4uL2JhY2tlbmQtc2VydmljZS1hcGkvbW9kZWxzL1BsYXlsaXN0UmVhZER0by50cyIsIi4uLy4uLy4uL2JhY2tlbmQtc2VydmljZS1hcGkvYXBpcy9QbGF5bGlzdEFwaS50cyIsIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9xdWFzYXIvc3JjL2RpcmVjdGl2ZXMvQ2xvc2VQb3B1cC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuLyogZXNsaW50LWRpc2FibGUgKi9cbi8qKlxuICogTXVzaWNEYXRhU2VydmljZVxuICogTm8gZGVzY3JpcHRpb24gcHJvdmlkZWQgKGdlbmVyYXRlZCBieSBPcGVuYXBpIEdlbmVyYXRvciBodHRwczovL2dpdGh1Yi5jb20vb3BlbmFwaXRvb2xzL29wZW5hcGktZ2VuZXJhdG9yKVxuICpcbiAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBPcGVuQVBJIGRvY3VtZW50OiAxLjBcbiAqIFxuICpcbiAqIE5PVEU6IFRoaXMgY2xhc3MgaXMgYXV0byBnZW5lcmF0ZWQgYnkgT3BlbkFQSSBHZW5lcmF0b3IgKGh0dHBzOi8vb3BlbmFwaS1nZW5lcmF0b3IudGVjaCkuXG4gKiBodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2hcbiAqIERvIG5vdCBlZGl0IHRoZSBjbGFzcyBtYW51YWxseS5cbiAqL1xuXG5cbi8qKlxuICogXG4gKiBAZXhwb3J0XG4gKi9cbmV4cG9ydCBjb25zdCBQbGF5bGlzdFZpc2liaWxpdHkgPSB7XG4gICAgUHVibGljOiAnUHVibGljJyxcbiAgICBQcml2YXRlOiAnUHJpdmF0ZScsXG4gICAgVW5saXN0ZWQ6ICdVbmxpc3RlZCdcbn0gYXMgY29uc3Q7XG5leHBvcnQgdHlwZSBQbGF5bGlzdFZpc2liaWxpdHkgPSB0eXBlb2YgUGxheWxpc3RWaXNpYmlsaXR5W2tleW9mIHR5cGVvZiBQbGF5bGlzdFZpc2liaWxpdHldO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdFZpc2liaWxpdHlGcm9tSlNPTihqc29uOiBhbnkpOiBQbGF5bGlzdFZpc2liaWxpdHkge1xuICAgIHJldHVybiBQbGF5bGlzdFZpc2liaWxpdHlGcm9tSlNPTlR5cGVkKGpzb24sIGZhbHNlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFBsYXlsaXN0VmlzaWJpbGl0eUZyb21KU09OVHlwZWQoanNvbjogYW55LCBpZ25vcmVEaXNjcmltaW5hdG9yOiBib29sZWFuKTogUGxheWxpc3RWaXNpYmlsaXR5IHtcbiAgICByZXR1cm4ganNvbiBhcyBQbGF5bGlzdFZpc2liaWxpdHk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdFZpc2liaWxpdHlUb0pTT04odmFsdWU/OiBQbGF5bGlzdFZpc2liaWxpdHkgfCBudWxsKTogYW55IHtcbiAgICByZXR1cm4gdmFsdWUgYXMgYW55O1xufVxuXG4iLCIvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuLyogZXNsaW50LWRpc2FibGUgKi9cbi8qKlxuICogTXVzaWNEYXRhU2VydmljZVxuICogTm8gZGVzY3JpcHRpb24gcHJvdmlkZWQgKGdlbmVyYXRlZCBieSBPcGVuYXBpIEdlbmVyYXRvciBodHRwczovL2dpdGh1Yi5jb20vb3BlbmFwaXRvb2xzL29wZW5hcGktZ2VuZXJhdG9yKVxuICpcbiAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBPcGVuQVBJIGRvY3VtZW50OiAxLjBcbiAqIFxuICpcbiAqIE5PVEU6IFRoaXMgY2xhc3MgaXMgYXV0byBnZW5lcmF0ZWQgYnkgT3BlbkFQSSBHZW5lcmF0b3IgKGh0dHBzOi8vb3BlbmFwaS1nZW5lcmF0b3IudGVjaCkuXG4gKiBodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2hcbiAqIERvIG5vdCBlZGl0IHRoZSBjbGFzcyBtYW51YWxseS5cbiAqL1xuXG5pbXBvcnQgeyBleGlzdHMsIG1hcFZhbHVlcyB9IGZyb20gJy4uL3J1bnRpbWUnO1xuaW1wb3J0IHR5cGUgeyBQbGF5bGlzdFZpc2liaWxpdHkgfSBmcm9tICcuL1BsYXlsaXN0VmlzaWJpbGl0eSc7XG5pbXBvcnQge1xuICAgIFBsYXlsaXN0VmlzaWJpbGl0eUZyb21KU09OLFxuICAgIFBsYXlsaXN0VmlzaWJpbGl0eUZyb21KU09OVHlwZWQsXG4gICAgUGxheWxpc3RWaXNpYmlsaXR5VG9KU09OLFxufSBmcm9tICcuL1BsYXlsaXN0VmlzaWJpbGl0eSc7XG5cbi8qKlxuICogXG4gKiBAZXhwb3J0XG4gKiBAaW50ZXJmYWNlIFBsYXlsaXN0Q3JlYXRlUmVxdWVzdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBsYXlsaXN0Q3JlYXRlUmVxdWVzdCB7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKiBAbWVtYmVyb2YgUGxheWxpc3RDcmVhdGVSZXF1ZXN0XG4gICAgICovXG4gICAgbmFtZT86IHN0cmluZyB8IG51bGw7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHR5cGUge1BsYXlsaXN0VmlzaWJpbGl0eX1cbiAgICAgKiBAbWVtYmVyb2YgUGxheWxpc3RDcmVhdGVSZXF1ZXN0XG4gICAgICovXG4gICAgdmlzaWJpbGl0eT86IFBsYXlsaXN0VmlzaWJpbGl0eTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIGdpdmVuIG9iamVjdCBpbXBsZW1lbnRzIHRoZSBQbGF5bGlzdENyZWF0ZVJlcXVlc3QgaW50ZXJmYWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFuY2VPZlBsYXlsaXN0Q3JlYXRlUmVxdWVzdCh2YWx1ZTogb2JqZWN0KTogYm9vbGVhbiB7XG4gICAgbGV0IGlzSW5zdGFuY2UgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGlzSW5zdGFuY2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdENyZWF0ZVJlcXVlc3RGcm9tSlNPTihqc29uOiBhbnkpOiBQbGF5bGlzdENyZWF0ZVJlcXVlc3Qge1xuICAgIHJldHVybiBQbGF5bGlzdENyZWF0ZVJlcXVlc3RGcm9tSlNPTlR5cGVkKGpzb24sIGZhbHNlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFBsYXlsaXN0Q3JlYXRlUmVxdWVzdEZyb21KU09OVHlwZWQoanNvbjogYW55LCBpZ25vcmVEaXNjcmltaW5hdG9yOiBib29sZWFuKTogUGxheWxpc3RDcmVhdGVSZXF1ZXN0IHtcbiAgICBpZiAoKGpzb24gPT09IHVuZGVmaW5lZCkgfHwgKGpzb24gPT09IG51bGwpKSB7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcbiAgICAgICAgJ25hbWUnOiAhZXhpc3RzKGpzb24sICduYW1lJykgPyB1bmRlZmluZWQgOiBqc29uWyduYW1lJ10sXG4gICAgICAgICd2aXNpYmlsaXR5JzogIWV4aXN0cyhqc29uLCAndmlzaWJpbGl0eScpID8gdW5kZWZpbmVkIDogUGxheWxpc3RWaXNpYmlsaXR5RnJvbUpTT04oanNvblsndmlzaWJpbGl0eSddKSxcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUGxheWxpc3RDcmVhdGVSZXF1ZXN0VG9KU09OKHZhbHVlPzogUGxheWxpc3RDcmVhdGVSZXF1ZXN0IHwgbnVsbCk6IGFueSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcbiAgICAgICAgJ25hbWUnOiB2YWx1ZS5uYW1lLFxuICAgICAgICAndmlzaWJpbGl0eSc6IFBsYXlsaXN0VmlzaWJpbGl0eVRvSlNPTih2YWx1ZS52aXNpYmlsaXR5KSxcbiAgICB9O1xufVxuXG4iLCIvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuLyogZXNsaW50LWRpc2FibGUgKi9cbi8qKlxuICogTXVzaWNEYXRhU2VydmljZVxuICogTm8gZGVzY3JpcHRpb24gcHJvdmlkZWQgKGdlbmVyYXRlZCBieSBPcGVuYXBpIEdlbmVyYXRvciBodHRwczovL2dpdGh1Yi5jb20vb3BlbmFwaXRvb2xzL29wZW5hcGktZ2VuZXJhdG9yKVxuICpcbiAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBPcGVuQVBJIGRvY3VtZW50OiAxLjBcbiAqIFxuICpcbiAqIE5PVEU6IFRoaXMgY2xhc3MgaXMgYXV0byBnZW5lcmF0ZWQgYnkgT3BlbkFQSSBHZW5lcmF0b3IgKGh0dHBzOi8vb3BlbmFwaS1nZW5lcmF0b3IudGVjaCkuXG4gKiBodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2hcbiAqIERvIG5vdCBlZGl0IHRoZSBjbGFzcyBtYW51YWxseS5cbiAqL1xuXG5pbXBvcnQgeyBleGlzdHMsIG1hcFZhbHVlcyB9IGZyb20gJy4uL3J1bnRpbWUnO1xuLyoqXG4gKiBcbiAqIEBleHBvcnRcbiAqIEBpbnRlcmZhY2UgUGxheWxpc3RJdGVtUmVhZER0b1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFBsYXlsaXN0SXRlbVJlYWREdG8ge1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICogQG1lbWJlcm9mIFBsYXlsaXN0SXRlbVJlYWREdG9cbiAgICAgKi9cbiAgICB0cmFja0lkPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICogQG1lbWJlcm9mIFBsYXlsaXN0SXRlbVJlYWREdG9cbiAgICAgKi9cbiAgICBpbmRleD86IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBtZW1iZXJvZiBQbGF5bGlzdEl0ZW1SZWFkRHRvXG4gICAgICovXG4gICAgdGltZXNQbGF5ZWQ/OiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHR5cGUge0RhdGV9XG4gICAgICogQG1lbWJlcm9mIFBsYXlsaXN0SXRlbVJlYWREdG9cbiAgICAgKi9cbiAgICBkYXRlQWRkZWQ/OiBEYXRlO1xufVxuXG4vKipcbiAqIENoZWNrIGlmIGEgZ2l2ZW4gb2JqZWN0IGltcGxlbWVudHMgdGhlIFBsYXlsaXN0SXRlbVJlYWREdG8gaW50ZXJmYWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFuY2VPZlBsYXlsaXN0SXRlbVJlYWREdG8odmFsdWU6IG9iamVjdCk6IGJvb2xlYW4ge1xuICAgIGxldCBpc0luc3RhbmNlID0gdHJ1ZTtcblxuICAgIHJldHVybiBpc0luc3RhbmNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUGxheWxpc3RJdGVtUmVhZER0b0Zyb21KU09OKGpzb246IGFueSk6IFBsYXlsaXN0SXRlbVJlYWREdG8ge1xuICAgIHJldHVybiBQbGF5bGlzdEl0ZW1SZWFkRHRvRnJvbUpTT05UeXBlZChqc29uLCBmYWxzZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdEl0ZW1SZWFkRHRvRnJvbUpTT05UeXBlZChqc29uOiBhbnksIGlnbm9yZURpc2NyaW1pbmF0b3I6IGJvb2xlYW4pOiBQbGF5bGlzdEl0ZW1SZWFkRHRvIHtcbiAgICBpZiAoKGpzb24gPT09IHVuZGVmaW5lZCkgfHwgKGpzb24gPT09IG51bGwpKSB7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcbiAgICAgICAgJ3RyYWNrSWQnOiAhZXhpc3RzKGpzb24sICd0cmFja0lkJykgPyB1bmRlZmluZWQgOiBqc29uWyd0cmFja0lkJ10sXG4gICAgICAgICdpbmRleCc6ICFleGlzdHMoanNvbiwgJ2luZGV4JykgPyB1bmRlZmluZWQgOiBqc29uWydpbmRleCddLFxuICAgICAgICAndGltZXNQbGF5ZWQnOiAhZXhpc3RzKGpzb24sICd0aW1lc1BsYXllZCcpID8gdW5kZWZpbmVkIDoganNvblsndGltZXNQbGF5ZWQnXSxcbiAgICAgICAgJ2RhdGVBZGRlZCc6ICFleGlzdHMoanNvbiwgJ2RhdGVBZGRlZCcpID8gdW5kZWZpbmVkIDogKG5ldyBEYXRlKGpzb25bJ2RhdGVBZGRlZCddKSksXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFBsYXlsaXN0SXRlbVJlYWREdG9Ub0pTT04odmFsdWU/OiBQbGF5bGlzdEl0ZW1SZWFkRHRvIHwgbnVsbCk6IGFueSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcbiAgICAgICAgJ3RyYWNrSWQnOiB2YWx1ZS50cmFja0lkLFxuICAgICAgICAnaW5kZXgnOiB2YWx1ZS5pbmRleCxcbiAgICAgICAgJ3RpbWVzUGxheWVkJzogdmFsdWUudGltZXNQbGF5ZWQsXG4gICAgICAgICdkYXRlQWRkZWQnOiB2YWx1ZS5kYXRlQWRkZWQgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6ICh2YWx1ZS5kYXRlQWRkZWQudG9JU09TdHJpbmcoKSksXG4gICAgfTtcbn1cblxuIiwiLyogdHNsaW50OmRpc2FibGUgKi9cbi8qIGVzbGludC1kaXNhYmxlICovXG4vKipcbiAqIE11c2ljRGF0YVNlcnZpY2VcbiAqIE5vIGRlc2NyaXB0aW9uIHByb3ZpZGVkIChnZW5lcmF0ZWQgYnkgT3BlbmFwaSBHZW5lcmF0b3IgaHR0cHM6Ly9naXRodWIuY29tL29wZW5hcGl0b29scy9vcGVuYXBpLWdlbmVyYXRvcilcbiAqXG4gKiBUaGUgdmVyc2lvbiBvZiB0aGUgT3BlbkFQSSBkb2N1bWVudDogMS4wXG4gKiBcbiAqXG4gKiBOT1RFOiBUaGlzIGNsYXNzIGlzIGF1dG8gZ2VuZXJhdGVkIGJ5IE9wZW5BUEkgR2VuZXJhdG9yIChodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2gpLlxuICogaHR0cHM6Ly9vcGVuYXBpLWdlbmVyYXRvci50ZWNoXG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXG4gKi9cblxuXG4vKipcbiAqIFxuICogQGV4cG9ydFxuICovXG5leHBvcnQgY29uc3QgUGxheWxpc3RUeXBlID0ge1xuICAgIE5vcm1hbDogJ05vcm1hbCcsXG4gICAgRmF2b3JpdGU6ICdGYXZvcml0ZScsXG4gICAgSGlzdG9yeTogJ0hpc3RvcnknLFxuICAgIFF1ZXVlOiAnUXVldWUnXG59IGFzIGNvbnN0O1xuZXhwb3J0IHR5cGUgUGxheWxpc3RUeXBlID0gdHlwZW9mIFBsYXlsaXN0VHlwZVtrZXlvZiB0eXBlb2YgUGxheWxpc3RUeXBlXTtcblxuXG5leHBvcnQgZnVuY3Rpb24gUGxheWxpc3RUeXBlRnJvbUpTT04oanNvbjogYW55KTogUGxheWxpc3RUeXBlIHtcbiAgICByZXR1cm4gUGxheWxpc3RUeXBlRnJvbUpTT05UeXBlZChqc29uLCBmYWxzZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdFR5cGVGcm9tSlNPTlR5cGVkKGpzb246IGFueSwgaWdub3JlRGlzY3JpbWluYXRvcjogYm9vbGVhbik6IFBsYXlsaXN0VHlwZSB7XG4gICAgcmV0dXJuIGpzb24gYXMgUGxheWxpc3RUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUGxheWxpc3RUeXBlVG9KU09OKHZhbHVlPzogUGxheWxpc3RUeXBlIHwgbnVsbCk6IGFueSB7XG4gICAgcmV0dXJuIHZhbHVlIGFzIGFueTtcbn1cblxuIiwiLyogdHNsaW50OmRpc2FibGUgKi9cbi8qIGVzbGludC1kaXNhYmxlICovXG4vKipcbiAqIE11c2ljRGF0YVNlcnZpY2VcbiAqIE5vIGRlc2NyaXB0aW9uIHByb3ZpZGVkIChnZW5lcmF0ZWQgYnkgT3BlbmFwaSBHZW5lcmF0b3IgaHR0cHM6Ly9naXRodWIuY29tL29wZW5hcGl0b29scy9vcGVuYXBpLWdlbmVyYXRvcilcbiAqXG4gKiBUaGUgdmVyc2lvbiBvZiB0aGUgT3BlbkFQSSBkb2N1bWVudDogMS4wXG4gKiBcbiAqXG4gKiBOT1RFOiBUaGlzIGNsYXNzIGlzIGF1dG8gZ2VuZXJhdGVkIGJ5IE9wZW5BUEkgR2VuZXJhdG9yIChodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2gpLlxuICogaHR0cHM6Ly9vcGVuYXBpLWdlbmVyYXRvci50ZWNoXG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXG4gKi9cblxuaW1wb3J0IHsgZXhpc3RzLCBtYXBWYWx1ZXMgfSBmcm9tICcuLi9ydW50aW1lJztcbmltcG9ydCB0eXBlIHsgUGxheWxpc3RJdGVtUmVhZER0byB9IGZyb20gJy4vUGxheWxpc3RJdGVtUmVhZER0byc7XG5pbXBvcnQge1xuICAgIFBsYXlsaXN0SXRlbVJlYWREdG9Gcm9tSlNPTixcbiAgICBQbGF5bGlzdEl0ZW1SZWFkRHRvRnJvbUpTT05UeXBlZCxcbiAgICBQbGF5bGlzdEl0ZW1SZWFkRHRvVG9KU09OLFxufSBmcm9tICcuL1BsYXlsaXN0SXRlbVJlYWREdG8nO1xuaW1wb3J0IHR5cGUgeyBQbGF5bGlzdFR5cGUgfSBmcm9tICcuL1BsYXlsaXN0VHlwZSc7XG5pbXBvcnQge1xuICAgIFBsYXlsaXN0VHlwZUZyb21KU09OLFxuICAgIFBsYXlsaXN0VHlwZUZyb21KU09OVHlwZWQsXG4gICAgUGxheWxpc3RUeXBlVG9KU09OLFxufSBmcm9tICcuL1BsYXlsaXN0VHlwZSc7XG5pbXBvcnQgdHlwZSB7IFBsYXlsaXN0VmlzaWJpbGl0eSB9IGZyb20gJy4vUGxheWxpc3RWaXNpYmlsaXR5JztcbmltcG9ydCB7XG4gICAgUGxheWxpc3RWaXNpYmlsaXR5RnJvbUpTT04sXG4gICAgUGxheWxpc3RWaXNpYmlsaXR5RnJvbUpTT05UeXBlZCxcbiAgICBQbGF5bGlzdFZpc2liaWxpdHlUb0pTT04sXG59IGZyb20gJy4vUGxheWxpc3RWaXNpYmlsaXR5JztcblxuLyoqXG4gKiBcbiAqIEBleHBvcnRcbiAqIEBpbnRlcmZhY2UgUGxheWxpc3RSZWFkRHRvXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGxheWxpc3RSZWFkRHRvIHtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqIEBtZW1iZXJvZiBQbGF5bGlzdFJlYWREdG9cbiAgICAgKi9cbiAgICBpZD86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqIEBtZW1iZXJvZiBQbGF5bGlzdFJlYWREdG9cbiAgICAgKi9cbiAgICBuYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqIEBtZW1iZXJvZiBQbGF5bGlzdFJlYWREdG9cbiAgICAgKi9cbiAgICB1c2VySWQ/OiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKiBAbWVtYmVyb2YgUGxheWxpc3RSZWFkRHRvXG4gICAgICovXG4gICAgdXNlcm5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEB0eXBlIHtQbGF5bGlzdFZpc2liaWxpdHl9XG4gICAgICogQG1lbWJlcm9mIFBsYXlsaXN0UmVhZER0b1xuICAgICAqL1xuICAgIHZpc2liaWxpdHk/OiBQbGF5bGlzdFZpc2liaWxpdHk7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHR5cGUge1BsYXlsaXN0VHlwZX1cbiAgICAgKiBAbWVtYmVyb2YgUGxheWxpc3RSZWFkRHRvXG4gICAgICovXG4gICAgdHlwZT86IFBsYXlsaXN0VHlwZTtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7RGF0ZX1cbiAgICAgKiBAbWVtYmVyb2YgUGxheWxpc3RSZWFkRHRvXG4gICAgICovXG4gICAgbGFzdE1vZGlmaWVkPzogRGF0ZTtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBtZW1iZXJvZiBQbGF5bGlzdFJlYWREdG9cbiAgICAgKi9cbiAgICBudW1iZXJPZlRyYWNrcz86IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7QXJyYXk8UGxheWxpc3RJdGVtUmVhZER0bz59XG4gICAgICogQG1lbWJlcm9mIFBsYXlsaXN0UmVhZER0b1xuICAgICAqL1xuICAgIHRyYWNrcz86IEFycmF5PFBsYXlsaXN0SXRlbVJlYWREdG8+IHwgbnVsbDtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIGdpdmVuIG9iamVjdCBpbXBsZW1lbnRzIHRoZSBQbGF5bGlzdFJlYWREdG8gaW50ZXJmYWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFuY2VPZlBsYXlsaXN0UmVhZER0byh2YWx1ZTogb2JqZWN0KTogYm9vbGVhbiB7XG4gICAgbGV0IGlzSW5zdGFuY2UgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGlzSW5zdGFuY2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdFJlYWREdG9Gcm9tSlNPTihqc29uOiBhbnkpOiBQbGF5bGlzdFJlYWREdG8ge1xuICAgIHJldHVybiBQbGF5bGlzdFJlYWREdG9Gcm9tSlNPTlR5cGVkKGpzb24sIGZhbHNlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFBsYXlsaXN0UmVhZER0b0Zyb21KU09OVHlwZWQoanNvbjogYW55LCBpZ25vcmVEaXNjcmltaW5hdG9yOiBib29sZWFuKTogUGxheWxpc3RSZWFkRHRvIHtcbiAgICBpZiAoKGpzb24gPT09IHVuZGVmaW5lZCkgfHwgKGpzb24gPT09IG51bGwpKSB7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcbiAgICAgICAgJ2lkJzogIWV4aXN0cyhqc29uLCAnaWQnKSA/IHVuZGVmaW5lZCA6IGpzb25bJ2lkJ10sXG4gICAgICAgICduYW1lJzogIWV4aXN0cyhqc29uLCAnbmFtZScpID8gdW5kZWZpbmVkIDoganNvblsnbmFtZSddLFxuICAgICAgICAndXNlcklkJzogIWV4aXN0cyhqc29uLCAndXNlcklkJykgPyB1bmRlZmluZWQgOiBqc29uWyd1c2VySWQnXSxcbiAgICAgICAgJ3VzZXJuYW1lJzogIWV4aXN0cyhqc29uLCAndXNlcm5hbWUnKSA/IHVuZGVmaW5lZCA6IGpzb25bJ3VzZXJuYW1lJ10sXG4gICAgICAgICd2aXNpYmlsaXR5JzogIWV4aXN0cyhqc29uLCAndmlzaWJpbGl0eScpID8gdW5kZWZpbmVkIDogUGxheWxpc3RWaXNpYmlsaXR5RnJvbUpTT04oanNvblsndmlzaWJpbGl0eSddKSxcbiAgICAgICAgJ3R5cGUnOiAhZXhpc3RzKGpzb24sICd0eXBlJykgPyB1bmRlZmluZWQgOiBQbGF5bGlzdFR5cGVGcm9tSlNPTihqc29uWyd0eXBlJ10pLFxuICAgICAgICAnbGFzdE1vZGlmaWVkJzogIWV4aXN0cyhqc29uLCAnbGFzdE1vZGlmaWVkJykgPyB1bmRlZmluZWQgOiAobmV3IERhdGUoanNvblsnbGFzdE1vZGlmaWVkJ10pKSxcbiAgICAgICAgJ251bWJlck9mVHJhY2tzJzogIWV4aXN0cyhqc29uLCAnbnVtYmVyT2ZUcmFja3MnKSA/IHVuZGVmaW5lZCA6IGpzb25bJ251bWJlck9mVHJhY2tzJ10sXG4gICAgICAgICd0cmFja3MnOiAhZXhpc3RzKGpzb24sICd0cmFja3MnKSA/IHVuZGVmaW5lZCA6IChqc29uWyd0cmFja3MnXSA9PT0gbnVsbCA/IG51bGwgOiAoanNvblsndHJhY2tzJ10gYXMgQXJyYXk8YW55PikubWFwKFBsYXlsaXN0SXRlbVJlYWREdG9Gcm9tSlNPTikpLFxuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQbGF5bGlzdFJlYWREdG9Ub0pTT04odmFsdWU/OiBQbGF5bGlzdFJlYWREdG8gfCBudWxsKTogYW55IHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIFxuICAgICAgICAnaWQnOiB2YWx1ZS5pZCxcbiAgICAgICAgJ25hbWUnOiB2YWx1ZS5uYW1lLFxuICAgICAgICAndXNlcklkJzogdmFsdWUudXNlcklkLFxuICAgICAgICAndXNlcm5hbWUnOiB2YWx1ZS51c2VybmFtZSxcbiAgICAgICAgJ3Zpc2liaWxpdHknOiBQbGF5bGlzdFZpc2liaWxpdHlUb0pTT04odmFsdWUudmlzaWJpbGl0eSksXG4gICAgICAgICd0eXBlJzogUGxheWxpc3RUeXBlVG9KU09OKHZhbHVlLnR5cGUpLFxuICAgICAgICAnbGFzdE1vZGlmaWVkJzogdmFsdWUubGFzdE1vZGlmaWVkID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiAodmFsdWUubGFzdE1vZGlmaWVkLnRvSVNPU3RyaW5nKCkpLFxuICAgICAgICAnbnVtYmVyT2ZUcmFja3MnOiB2YWx1ZS5udW1iZXJPZlRyYWNrcyxcbiAgICAgICAgJ3RyYWNrcyc6IHZhbHVlLnRyYWNrcyA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogKHZhbHVlLnRyYWNrcyA9PT0gbnVsbCA/IG51bGwgOiAodmFsdWUudHJhY2tzIGFzIEFycmF5PGFueT4pLm1hcChQbGF5bGlzdEl0ZW1SZWFkRHRvVG9KU09OKSksXG4gICAgfTtcbn1cblxuIiwiLyogdHNsaW50OmRpc2FibGUgKi9cbi8qIGVzbGludC1kaXNhYmxlICovXG4vKipcbiAqIE11c2ljRGF0YVNlcnZpY2VcbiAqIE5vIGRlc2NyaXB0aW9uIHByb3ZpZGVkIChnZW5lcmF0ZWQgYnkgT3BlbmFwaSBHZW5lcmF0b3IgaHR0cHM6Ly9naXRodWIuY29tL29wZW5hcGl0b29scy9vcGVuYXBpLWdlbmVyYXRvcilcbiAqXG4gKiBUaGUgdmVyc2lvbiBvZiB0aGUgT3BlbkFQSSBkb2N1bWVudDogMS4wXG4gKiBcbiAqXG4gKiBOT1RFOiBUaGlzIGNsYXNzIGlzIGF1dG8gZ2VuZXJhdGVkIGJ5IE9wZW5BUEkgR2VuZXJhdG9yIChodHRwczovL29wZW5hcGktZ2VuZXJhdG9yLnRlY2gpLlxuICogaHR0cHM6Ly9vcGVuYXBpLWdlbmVyYXRvci50ZWNoXG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXG4gKi9cblxuXG5pbXBvcnQgKiBhcyBydW50aW1lIGZyb20gJy4uL3J1bnRpbWUnO1xuaW1wb3J0IHR5cGUge1xuICBQbGF5bGlzdENyZWF0ZVJlcXVlc3QsXG4gIFBsYXlsaXN0UmVhZER0byxcbn0gZnJvbSAnLi4vbW9kZWxzJztcbmltcG9ydCB7XG4gICAgUGxheWxpc3RDcmVhdGVSZXF1ZXN0RnJvbUpTT04sXG4gICAgUGxheWxpc3RDcmVhdGVSZXF1ZXN0VG9KU09OLFxuICAgIFBsYXlsaXN0UmVhZER0b0Zyb21KU09OLFxuICAgIFBsYXlsaXN0UmVhZER0b1RvSlNPTixcbn0gZnJvbSAnLi4vbW9kZWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBBcGlQbGF5bGlzdFBvc3RSZXF1ZXN0IHtcbiAgICBwbGF5bGlzdENyZWF0ZVJlcXVlc3Q/OiBQbGF5bGlzdENyZWF0ZVJlcXVlc3Q7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0UGxheWxpc3RSZXF1ZXN0IHtcbiAgICBwbGF5bGlzdElkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0VXNlclBsYXlsaXN0UmVxdWVzdCB7XG4gICAgdXNlcklkOiBzdHJpbmc7XG59XG5cbi8qKlxuICogXG4gKi9cbmV4cG9ydCBjbGFzcyBQbGF5bGlzdEFwaSBleHRlbmRzIHJ1bnRpbWUuQmFzZUFQSSB7XG5cbiAgICAvKipcbiAgICAgKi9cbiAgICBhc3luYyBhcGlQbGF5bGlzdFBvc3RSYXcocmVxdWVzdFBhcmFtZXRlcnM6IEFwaVBsYXlsaXN0UG9zdFJlcXVlc3QsIGluaXRPdmVycmlkZXM/OiBSZXF1ZXN0SW5pdCB8IHJ1bnRpbWUuSW5pdE92ZXJyaWRlRnVuY3Rpb24pOiBQcm9taXNlPHJ1bnRpbWUuQXBpUmVzcG9uc2U8UGxheWxpc3RSZWFkRHRvPj4ge1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuXG4gICAgICAgIGNvbnN0IGhlYWRlclBhcmFtZXRlcnM6IHJ1bnRpbWUuSFRUUEhlYWRlcnMgPSB7fTtcblxuICAgICAgICBoZWFkZXJQYXJhbWV0ZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uLXBhdGNoK2pzb24nO1xuXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24gJiYgdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleSkge1xuICAgICAgICAgICAgaGVhZGVyUGFyYW1ldGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSB0aGlzLmNvbmZpZ3VyYXRpb24uYXBpS2V5KFwiQXV0aG9yaXphdGlvblwiKTsgLy8gSnd0IGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiBgL2FwaS9wbGF5bGlzdGAsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtZXRlcnMsXG4gICAgICAgICAgICBxdWVyeTogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgYm9keTogUGxheWxpc3RDcmVhdGVSZXF1ZXN0VG9KU09OKHJlcXVlc3RQYXJhbWV0ZXJzLnBsYXlsaXN0Q3JlYXRlUmVxdWVzdCksXG4gICAgICAgIH0sIGluaXRPdmVycmlkZXMpO1xuXG4gICAgICAgIHJldHVybiBuZXcgcnVudGltZS5KU09OQXBpUmVzcG9uc2UocmVzcG9uc2UsIChqc29uVmFsdWUpID0+IFBsYXlsaXN0UmVhZER0b0Zyb21KU09OKGpzb25WYWx1ZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqL1xuICAgIGFzeW5jIGFwaVBsYXlsaXN0UG9zdChyZXF1ZXN0UGFyYW1ldGVyczogQXBpUGxheWxpc3RQb3N0UmVxdWVzdCA9IHt9LCBpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxQbGF5bGlzdFJlYWREdG8+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmFwaVBsYXlsaXN0UG9zdFJhdyhyZXF1ZXN0UGFyYW1ldGVycywgaW5pdE92ZXJyaWRlcyk7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS52YWx1ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqL1xuICAgIGFzeW5jIGdldEN1cnJlbnRVc2VyRmF2b3JpdGVSYXcoaW5pdE92ZXJyaWRlcz86IFJlcXVlc3RJbml0IHwgcnVudGltZS5Jbml0T3ZlcnJpZGVGdW5jdGlvbik6IFByb21pc2U8cnVudGltZS5BcGlSZXNwb25zZTxBcnJheTxQbGF5bGlzdFJlYWREdG8+Pj4ge1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuXG4gICAgICAgIGNvbnN0IGhlYWRlclBhcmFtZXRlcnM6IHJ1bnRpbWUuSFRUUEhlYWRlcnMgPSB7fTtcblxuICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uICYmIHRoaXMuY29uZmlndXJhdGlvbi5hcGlLZXkpIHtcbiAgICAgICAgICAgIGhlYWRlclBhcmFtZXRlcnNbXCJBdXRob3JpemF0aW9uXCJdID0gdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleShcIkF1dGhvcml6YXRpb25cIik7IC8vIEp3dCBhdXRoZW50aWNhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogYC9hcGkvcGxheWxpc3QvdXNlci9tZS9mYXZvcml0ZWAsXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1ldGVycyxcbiAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICAgIH0sIGluaXRPdmVycmlkZXMpO1xuXG4gICAgICAgIHJldHVybiBuZXcgcnVudGltZS5KU09OQXBpUmVzcG9uc2UocmVzcG9uc2UsIChqc29uVmFsdWUpID0+IGpzb25WYWx1ZS5tYXAoUGxheWxpc3RSZWFkRHRvRnJvbUpTT04pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKi9cbiAgICBhc3luYyBnZXRDdXJyZW50VXNlckZhdm9yaXRlKGluaXRPdmVycmlkZXM/OiBSZXF1ZXN0SW5pdCB8IHJ1bnRpbWUuSW5pdE92ZXJyaWRlRnVuY3Rpb24pOiBQcm9taXNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEN1cnJlbnRVc2VyRmF2b3JpdGVSYXcoaW5pdE92ZXJyaWRlcyk7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS52YWx1ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqL1xuICAgIGFzeW5jIGdldEN1cnJlbnRVc2VySGlzdG9yeVJhdyhpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxydW50aW1lLkFwaVJlc3BvbnNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG5cbiAgICAgICAgY29uc3QgaGVhZGVyUGFyYW1ldGVyczogcnVudGltZS5IVFRQSGVhZGVycyA9IHt9O1xuXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24gJiYgdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleSkge1xuICAgICAgICAgICAgaGVhZGVyUGFyYW1ldGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSB0aGlzLmNvbmZpZ3VyYXRpb24uYXBpS2V5KFwiQXV0aG9yaXphdGlvblwiKTsgLy8gSnd0IGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiBgL2FwaS9wbGF5bGlzdC91c2VyL21lL2hpc3RvcnlgLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtZXRlcnMsXG4gICAgICAgICAgICBxdWVyeTogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICB9LCBpbml0T3ZlcnJpZGVzKTtcblxuICAgICAgICByZXR1cm4gbmV3IHJ1bnRpbWUuSlNPTkFwaVJlc3BvbnNlKHJlc3BvbnNlLCAoanNvblZhbHVlKSA9PiBqc29uVmFsdWUubWFwKFBsYXlsaXN0UmVhZER0b0Zyb21KU09OKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q3VycmVudFVzZXJIaXN0b3J5KGluaXRPdmVycmlkZXM/OiBSZXF1ZXN0SW5pdCB8IHJ1bnRpbWUuSW5pdE92ZXJyaWRlRnVuY3Rpb24pOiBQcm9taXNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEN1cnJlbnRVc2VySGlzdG9yeVJhdyhpbml0T3ZlcnJpZGVzKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q3VycmVudFVzZXJQbGF5bGlzdFJhdyhpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxydW50aW1lLkFwaVJlc3BvbnNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG5cbiAgICAgICAgY29uc3QgaGVhZGVyUGFyYW1ldGVyczogcnVudGltZS5IVFRQSGVhZGVycyA9IHt9O1xuXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24gJiYgdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleSkge1xuICAgICAgICAgICAgaGVhZGVyUGFyYW1ldGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSB0aGlzLmNvbmZpZ3VyYXRpb24uYXBpS2V5KFwiQXV0aG9yaXphdGlvblwiKTsgLy8gSnd0IGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiBgL2FwaS9wbGF5bGlzdC91c2VyL21lYCxcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgICAgfSwgaW5pdE92ZXJyaWRlcyk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBydW50aW1lLkpTT05BcGlSZXNwb25zZShyZXNwb25zZSwgKGpzb25WYWx1ZSkgPT4ganNvblZhbHVlLm1hcChQbGF5bGlzdFJlYWREdG9Gcm9tSlNPTikpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqL1xuICAgIGFzeW5jIGdldEN1cnJlbnRVc2VyUGxheWxpc3QoaW5pdE92ZXJyaWRlcz86IFJlcXVlc3RJbml0IHwgcnVudGltZS5Jbml0T3ZlcnJpZGVGdW5jdGlvbik6IFByb21pc2U8QXJyYXk8UGxheWxpc3RSZWFkRHRvPj4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudFVzZXJQbGF5bGlzdFJhdyhpbml0T3ZlcnJpZGVzKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q3VycmVudFVzZXJRdWV1ZVJhdyhpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxydW50aW1lLkFwaVJlc3BvbnNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG5cbiAgICAgICAgY29uc3QgaGVhZGVyUGFyYW1ldGVyczogcnVudGltZS5IVFRQSGVhZGVycyA9IHt9O1xuXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24gJiYgdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleSkge1xuICAgICAgICAgICAgaGVhZGVyUGFyYW1ldGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSB0aGlzLmNvbmZpZ3VyYXRpb24uYXBpS2V5KFwiQXV0aG9yaXphdGlvblwiKTsgLy8gSnd0IGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiBgL2FwaS9wbGF5bGlzdC91c2VyL21lL3F1ZXVlYCxcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgICAgfSwgaW5pdE92ZXJyaWRlcyk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBydW50aW1lLkpTT05BcGlSZXNwb25zZShyZXNwb25zZSwgKGpzb25WYWx1ZSkgPT4ganNvblZhbHVlLm1hcChQbGF5bGlzdFJlYWREdG9Gcm9tSlNPTikpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqL1xuICAgIGFzeW5jIGdldEN1cnJlbnRVc2VyUXVldWUoaW5pdE92ZXJyaWRlcz86IFJlcXVlc3RJbml0IHwgcnVudGltZS5Jbml0T3ZlcnJpZGVGdW5jdGlvbik6IFByb21pc2U8QXJyYXk8UGxheWxpc3RSZWFkRHRvPj4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudFVzZXJRdWV1ZVJhdyhpbml0T3ZlcnJpZGVzKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICovXG4gICAgYXN5bmMgZ2V0UGxheWxpc3RSYXcocmVxdWVzdFBhcmFtZXRlcnM6IEdldFBsYXlsaXN0UmVxdWVzdCwgaW5pdE92ZXJyaWRlcz86IFJlcXVlc3RJbml0IHwgcnVudGltZS5Jbml0T3ZlcnJpZGVGdW5jdGlvbik6IFByb21pc2U8cnVudGltZS5BcGlSZXNwb25zZTxQbGF5bGlzdFJlYWREdG8+PiB7XG4gICAgICAgIGlmIChyZXF1ZXN0UGFyYW1ldGVycy5wbGF5bGlzdElkID09PSBudWxsIHx8IHJlcXVlc3RQYXJhbWV0ZXJzLnBsYXlsaXN0SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IHJ1bnRpbWUuUmVxdWlyZWRFcnJvcigncGxheWxpc3RJZCcsJ1JlcXVpcmVkIHBhcmFtZXRlciByZXF1ZXN0UGFyYW1ldGVycy5wbGF5bGlzdElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0UGxheWxpc3QuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuXG4gICAgICAgIGNvbnN0IGhlYWRlclBhcmFtZXRlcnM6IHJ1bnRpbWUuSFRUUEhlYWRlcnMgPSB7fTtcblxuICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uICYmIHRoaXMuY29uZmlndXJhdGlvbi5hcGlLZXkpIHtcbiAgICAgICAgICAgIGhlYWRlclBhcmFtZXRlcnNbXCJBdXRob3JpemF0aW9uXCJdID0gdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleShcIkF1dGhvcml6YXRpb25cIik7IC8vIEp3dCBhdXRoZW50aWNhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogYC9hcGkvcGxheWxpc3Qve3BsYXlsaXN0SWR9YC5yZXBsYWNlKGB7JHtcInBsYXlsaXN0SWRcIn19YCwgZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhyZXF1ZXN0UGFyYW1ldGVycy5wbGF5bGlzdElkKSkpLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtZXRlcnMsXG4gICAgICAgICAgICBxdWVyeTogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICB9LCBpbml0T3ZlcnJpZGVzKTtcblxuICAgICAgICByZXR1cm4gbmV3IHJ1bnRpbWUuSlNPTkFwaVJlc3BvbnNlKHJlc3BvbnNlLCAoanNvblZhbHVlKSA9PiBQbGF5bGlzdFJlYWREdG9Gcm9tSlNPTihqc29uVmFsdWUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKi9cbiAgICBhc3luYyBnZXRQbGF5bGlzdChyZXF1ZXN0UGFyYW1ldGVyczogR2V0UGxheWxpc3RSZXF1ZXN0LCBpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxQbGF5bGlzdFJlYWREdG8+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldFBsYXlsaXN0UmF3KHJlcXVlc3RQYXJhbWV0ZXJzLCBpbml0T3ZlcnJpZGVzKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICovXG4gICAgYXN5bmMgZ2V0VXNlclBsYXlsaXN0UmF3KHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRVc2VyUGxheWxpc3RSZXF1ZXN0LCBpbml0T3ZlcnJpZGVzPzogUmVxdWVzdEluaXQgfCBydW50aW1lLkluaXRPdmVycmlkZUZ1bmN0aW9uKTogUHJvbWlzZTxydW50aW1lLkFwaVJlc3BvbnNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+PiB7XG4gICAgICAgIGlmIChyZXF1ZXN0UGFyYW1ldGVycy51c2VySWQgPT09IG51bGwgfHwgcmVxdWVzdFBhcmFtZXRlcnMudXNlcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBydW50aW1lLlJlcXVpcmVkRXJyb3IoJ3VzZXJJZCcsJ1JlcXVpcmVkIHBhcmFtZXRlciByZXF1ZXN0UGFyYW1ldGVycy51c2VySWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRVc2VyUGxheWxpc3QuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuXG4gICAgICAgIGNvbnN0IGhlYWRlclBhcmFtZXRlcnM6IHJ1bnRpbWUuSFRUUEhlYWRlcnMgPSB7fTtcblxuICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uICYmIHRoaXMuY29uZmlndXJhdGlvbi5hcGlLZXkpIHtcbiAgICAgICAgICAgIGhlYWRlclBhcmFtZXRlcnNbXCJBdXRob3JpemF0aW9uXCJdID0gdGhpcy5jb25maWd1cmF0aW9uLmFwaUtleShcIkF1dGhvcml6YXRpb25cIik7IC8vIEp3dCBhdXRoZW50aWNhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogYC9hcGkvcGxheWxpc3QvdXNlci97dXNlcklkfWAucmVwbGFjZShgeyR7XCJ1c2VySWRcIn19YCwgZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhyZXF1ZXN0UGFyYW1ldGVycy51c2VySWQpKSksXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1ldGVycyxcbiAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICAgIH0sIGluaXRPdmVycmlkZXMpO1xuXG4gICAgICAgIHJldHVybiBuZXcgcnVudGltZS5KU09OQXBpUmVzcG9uc2UocmVzcG9uc2UsIChqc29uVmFsdWUpID0+IGpzb25WYWx1ZS5tYXAoUGxheWxpc3RSZWFkRHRvRnJvbUpTT04pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKi9cbiAgICBhc3luYyBnZXRVc2VyUGxheWxpc3QocmVxdWVzdFBhcmFtZXRlcnM6IEdldFVzZXJQbGF5bGlzdFJlcXVlc3QsIGluaXRPdmVycmlkZXM/OiBSZXF1ZXN0SW5pdCB8IHJ1bnRpbWUuSW5pdE92ZXJyaWRlRnVuY3Rpb24pOiBQcm9taXNlPEFycmF5PFBsYXlsaXN0UmVhZER0bz4+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldFVzZXJQbGF5bGlzdFJhdyhyZXF1ZXN0UGFyYW1ldGVycywgaW5pdE92ZXJyaWRlcyk7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS52YWx1ZSgpO1xuICAgIH1cblxufVxuIiwiaW1wb3J0IHsgY3JlYXRlRGlyZWN0aXZlIH0gZnJvbSAnLi4vdXRpbHMvcHJpdmF0ZS9jcmVhdGUuanMnXG5pbXBvcnQgeyBjbG9zZVBvcnRhbHMsIGdldFBvcnRhbFByb3h5IH0gZnJvbSAnLi4vdXRpbHMvcHJpdmF0ZS9wb3J0YWwuanMnXG5pbXBvcnQgeyBpc0tleUNvZGUgfSBmcm9tICcuLi91dGlscy9wcml2YXRlL2tleS1jb21wb3NpdGlvbi5qcydcbmltcG9ydCBnZXRTU1JQcm9wcyBmcm9tICcuLi91dGlscy9wcml2YXRlL25vb3Atc3NyLWRpcmVjdGl2ZS10cmFuc2Zvcm0uanMnXG5cbi8qXG4gKiBkZXB0aFxuICogICA8IDAgIC0tPiBjbG9zZSBhbGwgY2hhaW5cbiAqICAgMCAgICAtLT4gZGlzYWJsZWRcbiAqICAgPiAwICAtLT4gY2xvc2UgY2hhaW4gdXAgdG8gTiBwYXJlbnRcbiAqL1xuXG5mdW5jdGlvbiBnZXREZXB0aCAodmFsdWUpIHtcbiAgaWYgKHZhbHVlID09PSBmYWxzZSkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSB2b2lkIDApIHtcbiAgICByZXR1cm4gMVxuICB9XG5cbiAgY29uc3QgZGVwdGggPSBwYXJzZUludCh2YWx1ZSwgMTApXG4gIHJldHVybiBpc05hTihkZXB0aCkgPyAwIDogZGVwdGhcbn1cblxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlRGlyZWN0aXZlKF9fUVVBU0FSX1NTUl9TRVJWRVJfX1xuICA/IHsgbmFtZTogJ2Nsb3NlLXBvcHVwJywgZ2V0U1NSUHJvcHMgfVxuICA6IHtcbiAgICAgIG5hbWU6ICdjbG9zZS1wb3B1cCcsXG5cbiAgICAgIGJlZm9yZU1vdW50IChlbCwgeyB2YWx1ZSB9KSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IHtcbiAgICAgICAgICBkZXB0aDogZ2V0RGVwdGgodmFsdWUpLFxuXG4gICAgICAgICAgaGFuZGxlciAoZXZ0KSB7XG4gICAgICAgICAgICAvLyBhbGxvdyBAY2xpY2sgdG8gYmUgZW1pdHRlZFxuICAgICAgICAgICAgY3R4LmRlcHRoICE9PSAwICYmIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBwcm94eSA9IGdldFBvcnRhbFByb3h5KGVsKVxuICAgICAgICAgICAgICBpZiAocHJveHkgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGNsb3NlUG9ydGFscyhwcm94eSwgZXZ0LCBjdHguZGVwdGgpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSxcblxuICAgICAgICAgIGhhbmRsZXJLZXkgKGV2dCkge1xuICAgICAgICAgICAgaXNLZXlDb2RlKGV2dCwgMTMpID09PSB0cnVlICYmIGN0eC5oYW5kbGVyKGV2dClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBlbC5fX3FjbG9zZXBvcHVwID0gY3R4XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjdHguaGFuZGxlcilcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBjdHguaGFuZGxlcktleSlcbiAgICAgIH0sXG5cbiAgICAgIHVwZGF0ZWQgKGVsLCB7IHZhbHVlLCBvbGRWYWx1ZSB9KSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gb2xkVmFsdWUpIHtcbiAgICAgICAgICBlbC5fX3FjbG9zZXBvcHVwLmRlcHRoID0gZ2V0RGVwdGgodmFsdWUpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIGJlZm9yZVVubW91bnQgKGVsKSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IGVsLl9fcWNsb3NlcG9wdXBcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjdHguaGFuZGxlcilcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBjdHguaGFuZGxlcktleSlcbiAgICAgICAgZGVsZXRlIGVsLl9fcWNsb3NlcG9wdXBcbiAgICAgIH1cbiAgICB9XG4pXG4iXSwibmFtZXMiOlsicnVudGltZS5CYXNlQVBJIiwicnVudGltZS5KU09OQXBpUmVzcG9uc2UiLCJydW50aW1lLlJlcXVpcmVkRXJyb3IiXSwibWFwcGluZ3MiOiI7QUFtQk8sTUFBTSxxQkFBcUI7QUFBQSxFQUM5QixRQUFRO0FBQUEsRUFDUixTQUFTO0FBQUEsRUFDVCxVQUFVO0FBQ2Q7QUFJTyxTQUFTLDJCQUEyQixNQUErQjtBQUMvRCxTQUFBLGdDQUFnQyxJQUFXO0FBQ3REO0FBRWdCLFNBQUEsZ0NBQWdDLE1BQVcscUJBQWtEO0FBQ2xHLFNBQUE7QUFDWDtBQUVPLFNBQVMseUJBQXlCLE9BQXdDO0FBQ3RFLFNBQUE7QUFDWDtBQzZCTyxT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
